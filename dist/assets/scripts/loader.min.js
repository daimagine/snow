/*!
 * @overview RSVP - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/tildeio/rsvp.js/master/LICENSE
 * @version   3.0.18
 */
(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){return"object"==typeof t&&null!==t}function r(){}function o(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}function i(t){var e=t._promiseCallbacks;return e||(e=t._promiseCallbacks={}),e}function u(t,e){return"onerror"===t?void kt.on("error",e):2!==arguments.length?kt[t]:void(kt[t]=e)}function a(){setTimeout(function(){for(var t,e=0;e<Et.length;e++){t=Et[e];var n=t.payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),kt.trigger(t.name,t.payload)}Et.length=0},50)}function s(t,e,n){1===Et.push({name:t,payload:{key:e._guidKey,id:e._id,eventName:t,detail:e._result,childId:n&&n._id,label:e._label,timeStamp:_t(),error:kt["instrument-with-stack"]?new Error(e._label):null}})&&a()}function c(){return new TypeError("A promises callback cannot return that same promise.")}function f(){}function l(t){try{return t.then}catch(e){return Ot.error=e,Ot}}function h(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function p(t,e,n){kt.async(function(t){var r=!1,o=h(n,e,function(n){r||(r=!0,e!==n?y(t,n):g(t,n))},function(e){r||(r=!0,_(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,_(t,o))},t)}function d(t,e){e._state===xt?g(t,e._result):e._state===Tt?(e._onError=null,_(t,e._result)):w(e,void 0,function(n){e!==n?y(t,n):g(t,n)},function(e){_(t,e)})}function v(t,n){if(n.constructor===t.constructor)d(t,n);else{var r=l(n);r===Ot?_(t,Ot.error):void 0===r?g(t,n):e(r)?p(t,n,r):g(t,n)}}function y(e,n){e===n?g(e,n):t(n)?v(e,n):g(e,n)}function m(t){t._onError&&t._onError(t._result),b(t)}function g(t,e){t._state===St&&(t._result=e,t._state=xt,0===t._subscribers.length?kt.instrument&&At("fulfilled",t):kt.async(b,t))}function _(t,e){t._state===St&&(t._state=Tt,t._result=e,kt.async(m,t))}function w(t,e,n,r){var o=t._subscribers,i=o.length;t._onError=null,o[i]=e,o[i+xt]=n,o[i+Tt]=r,0===i&&t._state&&kt.async(b,t)}function b(t){var e=t._subscribers,n=t._state;if(kt.instrument&&At(n===xt?"fulfilled":"rejected",t),0!==e.length){for(var r,o,i=t._result,u=0;u<e.length;u+=3)r=e[u],o=e[u+n],r?A(n,r,o,i):o(i);t._subscribers.length=0}}function k(){this.error=null}function E(t,e){try{return t(e)}catch(n){return jt.error=n,jt}}function A(t,n,r,o){var i=e(r),u,a,s,f;if(i){if(u=E(r,o),u===jt?(f=!0,a=u.error,u=null):s=!0,n===u)return void _(n,c())}else u=o,s=!0;n._state!==St||(i&&s?y(n,u):f?_(n,a):t===xt?g(n,u):t===Tt&&_(n,u))}function S(t,e){var n=!1;try{e(function o(e){n||(n=!0,y(t,e))},function i(e){n||(n=!0,_(t,e))})}catch(r){_(t,r)}}function x(t,e,n){return t===xt?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function T(t,e,n,r){this._instanceConstructor=t,this.promise=new t(f,r),this._abortOnReject=n,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?g(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&g(this.promise,this._result))):_(this.promise,this._validationError())}function O(t,e){return new Ct(this,t,!0,e).promise}function j(t,e){function n(t){y(i,t)}function r(t){_(i,t)}var o=this,i=new o(f,e);if(!gt(t))return _(i,new TypeError("You must pass an array to race.")),i;for(var u=t.length,a=0;i._state===St&&u>a;a++)w(o.resolve(t[a]),void 0,n,r);return i}function C(t,e){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var r=new n(f,e);return y(r,t),r}function R(t,e){var n=this,r=new n(f,e);return _(r,t),r}function I(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function q(t,n){this._id=Mt++,this._label=n,this._state=void 0,this._result=void 0,this._subscribers=[],kt.instrument&&At("created",this),f!==t&&(e(t)||I(),this instanceof q||P(),S(this,t))}function N(t,e,n){this._superConstructor(t,e,!1,n)}function M(t,e){return new N(Vt,t,e).promise}function V(t,e){return Vt.all(t,e)}function D(t,e){Wt[Ut]=t,Wt[Ut+1]=e,Ut+=2,2===Ut&&Xt()}function H(){var t=process.nextTick,e=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(e)&&"0"===e[1]&&"10"===e[2]&&(t=setImmediate),function(){t(G)}}function U(){return function(){Jt(G)}}function Y(){var t=0,e=new Bt(G),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function J(){var t=new MessageChannel;return t.port1.onmessage=G,function(){t.port2.postMessage(0)}}function K(){return function(){setTimeout(G,1)}}function G(){for(var t=0;Ut>t;t+=2){var e=Wt[t],n=Wt[t+1];e(n),Wt[t]=void 0,Wt[t+1]=void 0}Ut=0}function L(){try{var t=require,e=t("vertx");return Jt=e.runOnLoop||e.runOnContext,U()}catch(n){return K()}}function B(t){var e={};return e.promise=new Vt(function(t,n){e.resolve=t,e.reject=n},t),e}function F(t,n,r){return Vt.all(t,r).then(function(t){if(!e(n))throw new TypeError("You must pass a function as filter's second argument.");for(var o=t.length,i=new Array(o),u=0;o>u;u++)i[u]=n(t[u]);return Vt.all(i,r).then(function(e){for(var n=new Array(o),r=0,i=0;o>i;i++)e[i]&&(n[r]=t[i],r++);return n.length=r,n})})}function Q(t,e,n){this._superConstructor(t,e,!0,n)}function W(t,e,n){this._superConstructor(t,e,!1,n)}function X(t,e){return new W(Vt,t,e).promise}function z(t,e){return new Zt(Vt,t,e).promise}function Z(t,n,r){return Vt.all(t,r).then(function(t){if(!e(n))throw new TypeError("You must pass a function as map's second argument.");for(var o=t.length,i=new Array(o),u=0;o>u;u++)i[u]=n(t[u]);return Vt.all(i,r)})}function tt(){this.value=void 0}function et(t){try{return t.then}catch(e){return re.value=e,re}}function nt(t,e,n){try{t.apply(e,n)}catch(r){return re.value=r,re}}function rt(t,e){for(var n={},r,o,i=t.length,u=new Array(i),a=0;i>a;a++)u[a]=t[a];for(o=0;o<e.length;o++)r=e[o],n[r]=u[o+1];return n}function ot(t){for(var e=t.length,n=new Array(e-1),r=1;e>r;r++)n[r-1]=t[r];return n}function it(t,e){return{then:function(n,r){return t.call(e,n,r)}}}function ut(t,e){var n=function(){for(var n=this,r=arguments.length,o=new Array(r+1),i,u=!1,a=0;r>a;++a){if(i=arguments[a],!u){if(u=ct(i),u===oe){var s=new Vt(f);return _(s,oe.value),s}u&&u!==!0&&(i=it(u,i))}o[a]=i}var c=new Vt(f);return o[r]=function(t,n){t?_(c,t):void 0===e?y(c,n):e===!0?y(c,ot(arguments)):gt(e)?y(c,rt(arguments,e)):y(c,n)},u?st(c,o,t,n):at(c,o,t,n)};return n.__proto__=t,n}function at(t,e,n,r){var o=nt(n,r,e);return o===re&&_(t,o.value),t}function st(t,e,n,r){return Vt.all(e).then(function(e){var o=nt(n,r,e);return o===re&&_(t,o.value),t})}function ct(t){return t&&"object"==typeof t?t.constructor===Vt?!0:et(t):!1}function ft(t,e){return Vt.race(t,e)}function lt(t,e){return Vt.reject(t,e)}function ht(t,e){return Vt.resolve(t,e)}function pt(t){throw setTimeout(function(){throw t}),t}function dt(t,e){kt.async(t,e)}function vt(){kt.on.apply(kt,arguments)}function yt(){kt.off.apply(kt,arguments)}var mt;mt=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var gt=mt,_t=Date.now||function(){return(new Date).getTime()},wt=Object.create||function(t){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof t)throw new TypeError("Argument must be an object");return r.prototype=t,new r},bt={mixin:function(t){return t.on=this.on,t.off=this.off,t.trigger=this.trigger,t._promiseCallbacks=void 0,t},on:function(t,e){var n=i(this),r;r=n[t],r||(r=n[t]=[]),-1===o(r,e)&&r.push(e)},off:function(t,e){var n=i(this),r,u;return e?(r=n[t],u=o(r,e),void(-1!==u&&r.splice(u,1))):void(n[t]=[])},trigger:function(t,e){var n=i(this),r,o;if(r=n[t])for(var u=0;u<r.length;u++)(o=r[u])(e)}},kt={instrument:!1};bt.mixin(kt);var Et=[],At=s,St=void 0,xt=1,Tt=2,Ot=new k,jt=new k,Ct=T;T.prototype._validateInput=function(t){return gt(t)},T.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},T.prototype._init=function(){this._result=new Array(this.length)},T.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,r=0;e._state===St&&t>r;r++)this._eachEntry(n[r],r)},T.prototype._eachEntry=function(t,e){var r=this._instanceConstructor;n(t)?t.constructor===r&&t._state!==St?(t._onError=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(r.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(xt,e,t))},T.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===St&&(this._remaining--,this._abortOnReject&&t===Tt?_(r,n):this._result[e]=this._makeResult(t,e,n)),0===this._remaining&&g(r,this._result)},T.prototype._makeResult=function(t,e,n){return n},T.prototype._willSettleAt=function(t,e){var n=this;w(t,void 0,function(t){n._settledAt(xt,e,t)},function(t){n._settledAt(Tt,e,t)})};var Rt=O,It=j,Pt=C,qt=R,Nt="rsvp_"+_t()+"-",Mt=0,Vt=q;q.cast=Pt,q.all=Rt,q.race=It,q.resolve=Pt,q.reject=qt,q.prototype={constructor:q,_guidKey:Nt,_onError:function(t){kt.async(function(e){setTimeout(function(){e._onError&&kt.trigger("error",t)},0)},this)},then:function(t,e,n){var r=this,o=r._state;if(o===xt&&!t||o===Tt&&!e)return kt.instrument&&At("chained",this,this),this;r._onError=null;var i=new this.constructor(f,n),u=r._result;if(kt.instrument&&At("chained",r,i),o){var a=arguments[o-1];kt.async(function(){A(o,i,a,u)})}else w(r,i,t,e);return i},"catch":function(t,e){return this.then(null,t,e)},"finally":function(t,e){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})},e)}},N.prototype=wt(Ct.prototype),N.prototype._superConstructor=Ct,N.prototype._makeResult=x,N.prototype._validationError=function(){return new Error("allSettled must be called with an array")};var Dt=M,Ht=V,Ut=0,Yt={}.toString,Jt,Kt=D,Gt="undefined"!=typeof window?window:void 0,Lt=Gt||{},Bt=Lt.MutationObserver||Lt.WebKitMutationObserver,Ft="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Qt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Wt=new Array(1e3),Xt;Xt=Ft?H():Bt?Y():Qt?J():void 0===Gt&&"function"==typeof require?L():K();var $t=B,zt=F,Zt=Q;Q.prototype=wt(Ct.prototype),Q.prototype._superConstructor=Ct,Q.prototype._init=function(){this._result={}},Q.prototype._validateInput=function(t){return t&&"object"==typeof t},Q.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},Q.prototype._enumerate=function(){var t=this.promise,e=this._input,n=[];for(var r in e)t._state===St&&Object.prototype.hasOwnProperty.call(e,r)&&n.push({position:r,entry:e[r]});var o=n.length;this._remaining=o;for(var i,u=0;t._state===St&&o>u;u++)i=n[u],this._eachEntry(i.entry,i.position)},W.prototype=wt(Zt.prototype),W.prototype._superConstructor=Ct,W.prototype._makeResult=x,W.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var te=X,ee=z,ne=Z,re=new tt,oe=new tt,ie=ut,ue=ft,ae=lt,se=ht,ce=pt;kt.async=Kt;var fe=se;if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var le=window.__PROMISE_INSTRUMENTATION__;u("instrument",!0);for(var he in le)le.hasOwnProperty(he)&&vt(he,le[he])}var pe={race:ue,Promise:Vt,allSettled:Dt,hash:ee,hashSettled:te,denodeify:ie,on:vt,off:yt,map:ne,filter:zt,resolve:se,reject:ae,all:Ht,rethrow:ce,defer:$t,EventTarget:bt,configure:u,async:dt};"function"==typeof define&&define.amd?define(function(){return pe}):"undefined"!=typeof module&&module.exports?module.exports=pe:"undefined"!=typeof this&&(this.RSVP=pe)}).call(this),function(t,e){"use strict";var n="[gerobak-load]",r=function(t,e,n){for(var r=0;r<t.length;r++)e.call(n,r,t[r])},o=function(t){var e=0,n=0,r=null,o=[],i=t;for(n=0;n<i.length;n++)r={},r[i[n][e]]=t[n][1],o.push(r);return o},i=function(){for(var t={},e=0,n=arguments.length,r;n>e;e++)for(r in arguments[e])arguments[e].hasOwnProperty(r)&&(t[r]=arguments[e][r]);return t},u=function(t){t=t||n;var o=[],i=e.querySelectorAll(t);return r(i,function(e){o.push(i[e].getAttribute(t.replace(/[\])}[{(]/g,"")))}),o},a=function(t){var e=[],n=u(t);return r(n,function(t){e.push(n[t].split(", "))}),e},s=function(t){var e=a(t),n=[],u=[],s=[],c="url:",f=[],l=[],h=[],p=[],d="options:null";return r(e,function(t,e){f.push(c.concat(e[0]))}),r(f,function(t,e){l.push(e.split(/:(.+)?/)),r(l,function(){n=o(l)})}),r(e,function(t,n){1===e[t].length&&e[t].push(d),h=n.slice(1),r(h,function(t,e){p.push(e.split(/:/)),r(p,function(){u=o(p)})})}),r(e,function(t){s.push(i(n[t],u[t]))}),console.log(s),s};t.gerobak={docking:function(t,e,r){if(t=t||n,0===e.length)return void r();var o=e[0];e=e.slice(1),basket.require(o).then(function(){gerobak.docking(t,e,r)})}},t.onload=function(){basket.clear(),gerobak.docking(n,s())}}(this,document),function(t,e){"use strict";var n=e.head||e.getElementsByTagName("head")[0],r="basket-",o=5e3,i=[],u=function(t,e){try{return localStorage.setItem(r+t,JSON.stringify(e)),!0}catch(n){if(n.name.toUpperCase().indexOf("QUOTA")>=0){var o,i=[];for(o in localStorage)0===o.indexOf(r)&&i.push(JSON.parse(localStorage[o]));return i.length?(i.sort(function(t,e){return t.stamp-e.stamp}),basket.remove(i[0].key),u(t,e)):void 0}return}},a=function(t){var e=new RSVP.Promise(function(e,n){var r=new XMLHttpRequest;r.open("GET",t),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status&&r.responseText?e({content:r.responseText,type:r.getResponseHeader("content-type")}):n(new Error(r.statusText)))},setTimeout(function(){r.readyState<4&&r.abort()},basket.timeout),r.send()});return e},s=function(t){return a(t.url).then(function(e){var n=c(t,e);return t.skipCache||u(t.key,n),n})},c=function(t,e){var n=+new Date;return t.data=e.content,t.originalType=e.type,t.type=t.type||e.type,t.skipCache=t.skipCache||!1,t.stamp=n,t.expire=n+60*(t.expire||o)*60*1e3,t},f=function(t,e){return!t||t.expire-+new Date<0||e.unique!==t.unique||basket.isValidItem&&!basket.isValidItem(t,e)},l=function(t){var e,n,r;if(t.url)return t.key=t.key||t.url,e=basket.get(t.key),t.execute=t.execute!==!1,r=f(e,t),t.live||r?(t.unique&&(t.url+=(t.url.indexOf("?")>0?"&":"?")+"basket-unique="+t.unique),n=s(t),t.live&&!r&&(n=n.then(function(t){return t},function(){return e}))):(e.type=t.type||e.originalType,e.execute=t.execute,n=new RSVP.Promise(function(t){t(e)})),n},h=function(t){var r=e.createElement("script");r.defer=!0,r.text=t.data,n.appendChild(r)},p={"default":h},d=function(t){return t.type&&p[t.type]?p[t.type](t):p["default"](t)},v=function(t){return t.map(function(t){return t.execute&&d(t),t})},y=function(){var t,e,n=[];for(t=0,e=arguments.length;e>t;t++)n.push(l(arguments[t]));return RSVP.all(n)},m=function(){var t=y.apply(null,arguments),e=this.then(function(){return t}).then(v);return e.thenRequire=m,e};t.basket={require:function(){for(var t=0,e=arguments.length;e>t;t++)arguments[t].execute=arguments[t].execute!==!1,arguments[t].once&&i.indexOf(arguments[t].url)>=0?arguments[t].execute=!1:arguments[t].execute!==!1&&i.indexOf(arguments[t].url)<0&&i.push(arguments[t].url);var n=y.apply(null,arguments).then(v);return n.thenRequire=m,n},remove:function(t){return localStorage.removeItem(r+t),this},get:function(t){var e=localStorage.getItem(r+t);try{return JSON.parse(e||"false")}catch(n){return!1}},clear:function(t){var e,n,o=+new Date;for(e in localStorage)n=e.split(r)[1],n&&(!t||this.get(n).expire<=o)&&this.remove(n);return this},isValidItem:null,timeout:5e3,addHandler:function(t,e){Array.isArray(t)||(t=[t]),t.forEach(function(t){p[t]=e})},removeHandler:function(t){basket.addHandler(t,void 0)}},basket.clear(!0)}(this,document);